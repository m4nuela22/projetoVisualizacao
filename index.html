<!DOCTYPE html>
<html>
    <head>
         <meta charset="utf-8">
         <title> Acidentes de Tr√¢nsito - Recife </title>
         <script src="https://d3js.org/d3.v4.min.js"></script>
         <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
                integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
                crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
                integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
                crossorigin=""></script>
        <script src="/js/leaflet-0.7.2/leaflet.ajax.min.js"></script>
        <script src="recurrentTimeSelectionWidget.js"></script>
        <script src="map.js"></script>
        <script src="histograma.js"></script>
        <script src="pie_chart.js"></script>
        <style>
            .pointer {
              cursor: pointer;
            }
        </style>

         <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
         <link rel="stylesheet" type="text/css" href="pie_chart.css">

    </head>
    <body>
          <div id="mapDiv" style="width: 600px; height: 400px; margin-left: 10px"></div>

          <div id="tooltip" class="hidden">
          <p><strong><span id="label">Tipo</span></strong></p>
          <p><span id="value">100</span>, <span id="percentage">100</span>%</p>
          </div>

          <script>
             var myDispath = d3.dispatch("selectionChanged");
              createMap();
              var margin = {top:10, right:10, bottom:10,left:10};
              var width = screen.width - margin.left - margin.right;
              var height = screen.height - margin.top - margin.bottom;

              var mainSVG = d3.select("body")
              .append("svg")
              .attr("id","mainSVG")
              .attr("width", width)
              .attr("height",height);

              d3.csv("acidentesTransito2015.csv",function(error, dataCSV2015) {
                  if (error) throw error;
                  d3.csv("acidentesTransito2016.csv",function(error, dataCSV2016) {
                      if (error) throw error;
                      createRecurrentTimeSelectionWidget(dataCSV2015,dataCSV2016);
                      dataCSV2015 = dataCSV2015.slice(0,100);
                      addMarkersToMap(dataCSV2015);
                      //addMarkersToMap(dataCSV2016);
                      histogram(dataCSV2015);
                      bakePie(dataCSV2015);

                  });
              });

              myDispath.on("selectionChanged",function(){
                var newData = this.selectedList;
                //histogram(newData);
                //addMarkersToMap(newData);
                //bakePie(newData);
                processData(newData);
              });

          </script>

          

    </body>
</html>
